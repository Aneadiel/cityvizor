<button class="btn btn-lg btn-default btn-infoModal pull-right"  (click)="infoModal.show();">
	<i class="fa fa-question-circle"></i> dfsf21515
</button>

<div class="row">

	<div class="col-lg-12">
		
		<!-- VIZUALIZACE -->
		<div id="bigbang" #drawing>
			
			<div class="whiteTransitions">
				<div class="topTransition" style=""></div><div class="bottomTransition" style=""></div>
			</div>
			
			<budgets-list [profile]="profile._id" type="expenditures" (select)="selectBudget($event)"></budgets-list>
			
			<div class="row">

				<div class="col-lg-8 col-lg-offset-2">

					<div class="box ratio2_1">
						<div class="content">
							<chart-bigbang [data]="groups" [max]="maxAmount" [selected]="state.group" [hovered]="hoveredGroup" (select)="selectGroup($event)" (hover)="hoveredGroup=$event"></chart-bigbang>
						</div>
					</div>

				</div>
			
			</div>
		</div>
		
		<div class="btn-group-selected">
			<div class="btn-group">
				<button type="button" class="btn btn-lg btn-red" *ngIf="state.group">
							<strong>{{groupIndex[state.group].title}}</strong>
				</button>
				<button type="button" class="btn btn-lg btn-red" *ngIf="!state.group">
						<strong>Vyberte skupinu..</strong>
						<div class="arrow_groupselecthint">asdf</div>
				</button>
				<button type="button" class="btn btn-lg btn-label">
					<div class="row">
						<div class="col-xs-3 text-right">
							<strong>Plnění</strong>
						</div>
						<div class="col-xs-9 text-right">
							{{10000 | money:0:false}} Kč
						</div>
					</div>
					<div class="row">
						<div class="col-xs-3 text-right">
							<strong>Rozpočet</strong>
						</div>
						<div class="col-xs-9 text-right">
							{{20000 | money:0:false}} Kč
						</div>
					</div>
				</button>

				<div class="btn-group" dropdown>
					<button dropdownToggle type="button" class="btn btn-lg btn-blue dropdown-toggle">
						Seznam <span class="caret"></span>
					</button>
					<ul *dropdownMenu class="dropdown-menu groupList" role="menu">
						<li role="menuitem" *ngFor="let group of groups" (mouseover)="hoveredGroup=group.id" (mouseout)="hoveredGroup=null" (click)="selectGroup(group.id)" [attr.class]="(hoveredGroup==group.id || state.group==group.id) ? 'group group-focus' : 'group'">
							<a>
								<div class="row">
									<div class="col-xs-2">
										<div class="bar">
											<div class="bar-budget" [style.width]="(group.budgetAmount / maxAmount * 100)+'%'">
												<div class="bar-expenditure" [style.width]="(group.amount / group.budgetAmount * 100)+'%'">
												</div>
											</div>
										</div>
									</div>
									<div class="col-xs-10 small analytics" [attr.data-analytics]="group.id">
										{{group.title}} <sub class="text-muted hidden">{{group.id}}</sub>
									</div>
								</div>
							</a>
						</li>
					</ul>
				</div>
			</div>
		</div>

		<div id="selectedGroup">

			<div *ngIf="groupIndex[state.group]">

				<div *ngFor="let paragraph of groupIndex[state.group].paragraphs" class="paragraph">

					<div class="row">
						<div class="col-md-12">
							<h4>&sect; {{paragraph.id}} - {{paragraphNames[paragraph.id]}} <span *ngIf="paragraph.expenditureAmount > paragraph.budgetExpenditureAmount" class="label label-warning">Překročen rozpočet!</span></h4>
						</div>
					</div>

					<div class="row">
						<div class="col-sm-9">
							<div class="content">

								<table class="viztable table table-responsive small">
									<thead>
										<tr>
											<th>Účel výdaje</th>
											<th>Rozpočtová částka</th>
											<th>Skutečný výdaj</th>
										</tr>
									</thead>
									<tbody>
										<tr *ngFor="let event of paragraph.events">
											<td>
												<a *ngIf="event.event" (click)="selectEvent(event)">{{getEventName(event.event)}}</a>
												<span *ngIf="!event.event">{{getEventName(event.event)}}</span>
											</td>
											<td>{{event.budgetExpenditureAmount | money:0:true}} Kč</td>
											<td>{{event.expenditureAmount | money:0:true}} Kč</td>
										</tr>
									</tbody>
								</table>
							</div>
						</div>
						<div class="col-xs-8 col-xs-offset-2 col-sm-3 col-sm-offset-0">
							<div class="row">
								<div class="col-xs-12">
									<table class="table graftable table-responsive small">
										<thead>
											<tr><th colspan=3>Stav čerpání rozpočtu</th></tr>
										</thead>
										<tbody>
											<tr>
													<td rowspan=3><chart-donut [data]="getDonutChartData(paragraph)"></chart-donut></td>
													<td>Rozpočet</td>
													<td>{{paragraph.budgetExpenditureAmount | money:0:true}} Kč</td>
											</tr>
											<tr>
													<td><span style="color:#E73431;">&#9632;</span> Čerpáno</td>
													<td>{{paragraph.expenditureAmount | money:0:true}} Kč</td>
											</tr>
											<tr *ngIf="paragraph.expenditureAmount <= paragraph.budgetExpenditureAmount">
													<td><span style="color:#ff9491;">&#9632;</span> Zbývá</td>
													<td>{{paragraph.budgetExpenditureAmount - paragraph.expenditureAmount | money:0:true}} Kč</td>
											</tr>
											<tr *ngIf="paragraph.expenditureAmount > paragraph.budgetExpenditureAmount">
													<td colspan=3>Překročeno o {{paragraph.expenditureAmount - paragraph.budgetExpenditureAmount | money:0:true}} Kč</td>
											</tr>
										</tbody>
									</table>
									
								</div>
							</div>
						</div>
					</div>					
				</div>
			</div>
		</div>
	</div>
</div>

<div bsModal #eventReceiptsModal="bs-modal" (onHide)="selectEvent(null)" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-lg">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" (click)="selectEvent(null)" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
				<h4 class="modal-title">{{eventIndex[state.event]?.name || "Projekt / akce"}}</h4>
			</div>
			<div class="modal-body">
				<event-detail [eventid]="state.event"></event-detail>
			</div>
		</div>
	</div>
</div>

<div bsModal #infoModal="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-lg">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" (click)="infoModal.hide()" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
				<h4 class="modal-title">Jak jsou členěny výdaje?</h4>
			</div>
			<div class="modal-body">
				<p>
					Výdaje jsou členěny dle účelu použití a je tedy možné vidět, za co konkrétně jsou veřejné prostředky vynakládány a komu jsou. V aplikaci Cityvizor jsou informace o skutečných výdajích spárovány s rozpočtovými daty. 
				</p>
			</div>
		</div>
	</div>
</div>